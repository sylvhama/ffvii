---
import clsx from "clsx";
import { getRelativeLocaleUrl } from "astro:i18n";
import { Icon } from "astro-icon/components";

import { useTranslations } from "@i18n/utils";
import Anchor from "./Anchor.astro";

const pages = ["games", "movies", "books", "music", "events", "merch"] as const;

type Page = (typeof pages)[number];

interface Props {
  currentPage: Page;
}

const { currentPage } = Astro.props;
const translate = useTranslations(Astro.currentLocale);
---

<nav aria-label={translate("categories")}>
  <ul
    class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-[auto_auto_auto_auto_auto_auto] gap-2 md:gap-0"
  >
    {
      pages.map((page, index) => {
        const isCurrent = currentPage === page;
        return (
          <li
            class={clsx(
              "md:p-2 text-center",
              isCurrent ? "md:border-x md:border-t" : "md:border-b",
              index === 0 &&
                "relative before:absolute before:border-b before:w-8 before:-left-8 before:-bottom-[1px] before:hidden md:before:block"
            )}
          >
            <Anchor
              href={
                isCurrent
                  ? ""
                  : getRelativeLocaleUrl(
                      Astro.currentLocale || "en",
                      page === "games" ? "" : page
                    )
              }
              classname={clsx(
                "group hover:before:hidden focus-visible:before:hidden text-xl uppercase font-mono break-words flex flex-wrap gap-2 items-center justify-center",
                isCurrent ? "font-bold" : ""
              )}
              aria-current={isCurrent ? "page" : undefined}
            >
              <div class="pointer group-hover:before:block group-focus-visible:before:block">
                <Icon name={page} aria-hidden="true" width="24" height="24" />
              </div>
              {translate(page)}
            </Anchor>
          </li>
        );
      })
    }
  </ul>
</nav>

<h2 class="sr-only">
  {translate(`${currentPage}Heading` as Page)}
</h2>
